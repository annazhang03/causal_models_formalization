
# Causality and Semantic Separation

This repository presents a semantics-driven formalization of causal models within the Rocq Prover. The
 formalization includes a library of graph-theoretic and causal-reasoning tools, 
encompassing key concepts such as mediators, confounders, and colliders.
 It introduces a novel semantic definition of _semantic separation_ and proves that it
 exactly coincides with _d_-separation, the classic condition on graphs in causal inference
 that determines when the design of an experiment controls for an appropriate set of variables.

## Repository Structure
- `Utils`: foundational definitions and helper lemmas for lists, logic, and type theory. 
   This directory contains general-purpose utilities that do not depend on graphs or causal concepts.
- `DAGs`: formalization of directed acyclic graphs (DAGs) in Rocq. Includes definitions of nodes, edges
   and paths, as well as key properties such as acyclicity, reachability, pathfinding, and topological
   sorting.
- `CausalDiagrams`: extensions of DAGs to causal settings. Defines notions specific to causal 
reasoning, such as _d_-separation, intermediate node classification, and interventions, building directly on the `DAGs` layer.
- `Semantics`: development of the semantic perspective on causal models. Includes the function-based
framework for causal semantics, the notion of semantic separation, and all supporting lemmas and 
theorems culminating in the fully mechanized equivalence proof between semantic separation and
_d_-separation.


## System and Build Information
- **Rocq version:** 8.20.1
- **Build system:** Makefile (auto-generated by `coq_makefile`)
- The `_CoqProject` file includes all the directories and source files necessary to build the development

To compile:

```bash
coq_makefile -f _CoqProject -o Makefile
make
```

## Assumptions and Admitted Lemmas
This Rocq development assumes two standard logical principles:
1. Functional Extensionality (imported from `Coq.Logic.FunctionalExtensionality`)
2. Classical Law of Excluded Middle (imported from `Coq.Logic.Classical`)

Some graph-theoretic correctness theorems are currently marked as `Admitted`.
They are limited to the following files and topics:
- `DAGs/PathFinding.v`: correctness of the `find_all_paths_from_start_to_end` function
- `DAGs/CycleDetection.v`: correctness of the `contains_cycle` function
- `DAGs/Descendants.v`: correctness of the `find_descendants` function and the `find_directed_paths_to_end` function
- `DAGs/TopologicalSort.v`: correctness of the `topological_sort` function

These theorems specify correctness of classic algorithms that are known to be implementable.
Therefore, while they are used in the developments in causal models and semantic reasoning,
any potential issue in their proofs would require modifying the implementation of the functions,
rather than the formal statements or proofs built on top of them.

Work is ongoing to fully mechanize these correctness proofs.

There are a small number of other admitted theorems in `CausalDiagrams/Interventions.v` and in the `Archive/` directory; these are purely auxiliary and not referenced in the semantic development.


## Key Content
Here we provide a concise guide to the most novel/important concepts and show where they are implemented in the repository.

### Types
- `graph`, `nodes`, and `edges` are defined in `DAGs/Basics_Constr.v`
- The `assignments` type (a mapping from nodes to values) is in `CausalDiagrams/Assignments.v`
- The specific type that node functions are eventually limited to, `EqType`, is defined in `Utils/EqType.v`
- The function-based semantics types `nodefun` and `graphfun` are introduced in `Semantics/FunctionRepresentation.v`

### Definitions
- The concept of unblocked ancestors, crucial in the equivalence proof, is defined in `CausalDiagrams/UnblockedAncestors.v`
- The `find_value` function for computing the value of a node is in `Semantics/FindValue.v`
- Semantic separation is formally defined in `Semantics/SemanticSeparationDef.v`

### Theorems
- The equivalence theorem between semantic separation and _d_-separation is mechanized in `Semantics/SemanticDSepEquiv.v`

